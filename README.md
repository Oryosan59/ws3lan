# ws3lan - Navigator Control System ğŸš€

![Build](https://img.shields.io/badge/build-passing-brightgreen)  
ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã‚»ãƒ³ã‚µåˆ¶å¾¡ãƒ»ã‚¹ãƒ©ã‚¹ã‚¿ãƒ¼æ“ä½œãƒ»ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰å…¥åŠ›ã®çµ±åˆå‡¦ç†ã‚’è¡Œã† C++ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ã™ã€‚BlueRobotics Navigator-lib ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’æ´»ç”¨ã—ã€ROS ãªã©ã‚’ä½¿ç”¨ã›ãšè»½é‡ã§çµ„ã¿è¾¼ã¿ã‚„ã™ã„åˆ¶å¾¡ç³»ã‚’æ§‹ç¯‰ã—ã¾ã™ã€‚

---

## âœ¨ ä¸»ãªæ©Ÿèƒ½

- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãªã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ï¼ˆIMUã€æ°—åœ§ã€æ°´æ¸©ãªã©ï¼‰ã®å–å¾— (â€»è¡¨ç¤ºãƒ»è¨˜éŒ²ã¯åœ°ä¸Šå±€ã‚„é€£æºã‚·ã‚¹ãƒ†ãƒ ã«ä¾å­˜)
- ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã‹ã‚‰ã®å…¥åŠ›ã«åŸºã¥ã„ãŸã‚¹ãƒ©ã‚¹ã‚¿ãƒ¼ã®ç²¾å¯†åˆ¶å¾¡
- ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯çµŒç”±ã§ã®é éš”æ“ä½œæŒ‡ç¤ºã®å—ä¿¡ãŠã‚ˆã³ãƒ†ãƒ¬ãƒ¡ãƒˆãƒªãƒ‡ãƒ¼ã‚¿ã®é€ä¿¡æ©Ÿèƒ½ (â€»å…·ä½“çš„ãªãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¯å®Ÿè£…ä¾å­˜)
- ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åŒ–ã•ã‚ŒãŸã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆ (ã‚»ãƒ³ã‚µãƒ¼ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã€ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã€ã‚¹ãƒ©ã‚¹ã‚¿ãƒ¼åˆ¶å¾¡)
- è»½é‡ãªå®Ÿè£…ã§ã€Raspberry Piãªã©ã®ãƒªã‚½ãƒ¼ã‚¹ãŒé™ã‚‰ã‚ŒãŸç’°å¢ƒã§ã®å‹•ä½œã‚’è€ƒæ…®
- ç•°å¸¸ç™ºç”Ÿæ™‚ã®ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•æ©Ÿæ§‹ (è©³ç´°ã¯å¾Œè¿°)

---

## ğŸ›¡ï¸ ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•æ©Ÿèƒ½

æœ¬ã‚·ã‚¹ãƒ†ãƒ ã«ã¯ã€é€šä¿¡æ–­çµ¶ã‚„ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã®æ¥ç¶šåˆ‡ã‚Œãªã©ã®ç•°å¸¸äº‹æ…‹ã«å‚™ãˆã€ä»¥ä¸‹ã®ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•æ©Ÿèƒ½ãŒå®Ÿè£…ã•ã‚Œã¦ã„ã¾ã™ã€‚

- **é€šä¿¡æ–­çµ¶æ™‚**: ä¸€å®šæ™‚é–“ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã‚„åœ°ä¸Šå±€ã‹ã‚‰ã®å…¥åŠ›ãŒãªã„å ´åˆã€ã‚¹ãƒ©ã‚¹ã‚¿ãƒ¼å‡ºåŠ›ã‚’åœæ­¢ã—ã€å®‰å…¨ãªçŠ¶æ…‹ã«ç§»è¡Œã—ã¾ã™ã€‚
- **ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰æ¥ç¶šåˆ‡ã‚Œ**: ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã®æ¥ç¶šãŒåˆ‡ã‚ŒãŸå ´åˆã€åŒæ§˜ã«ã‚¹ãƒ©ã‚¹ã‚¿ãƒ¼ã‚’åœæ­¢ã—ã¾ã™ã€‚
- **è¨­å®šå¯èƒ½ãªã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆ**: ãƒ•ã‚§ã‚¤ãƒ«ã‚»ãƒ¼ãƒ•ãŒä½œå‹•ã™ã‚‹ã¾ã§ã®ã‚¿ã‚¤ãƒ ã‚¢ã‚¦ãƒˆæ™‚é–“ã¯è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ç­‰ã§èª¿æ•´å¯èƒ½ã§ã™ã€‚ï¼ˆâ€» å°†æ¥çš„ãªæ‹¡å¼µã¾ãŸã¯å®Ÿè£…è©³ç´°ã‚’å‚ç…§ï¼‰

ã“ã‚Œã«ã‚ˆã‚Šã€äºˆæœŸã›ã¬çŠ¶æ³ä¸‹ã§ã‚‚æ©Ÿä½“ã®å®‰å…¨ã‚’ç¢ºä¿ã—ã¾ã™ã€‚

## ğŸ—‚ï¸ ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹æˆ

```plaintext
WS3/
â”œâ”€â”€ Makefile.mk         # Makefile
â”œâ”€â”€ src/                # ã‚½ãƒ¼ã‚¹ãƒ•ã‚¡ã‚¤ãƒ« (.cpp)
â”‚   â”œâ”€â”€ main.cpp
â”‚   â”œâ”€â”€ network.cpp
â”‚   â”œâ”€â”€ gamepad.cpp
â”‚   â”œâ”€â”€ thruster_control.cpp
â”‚   â””â”€â”€ sensor_data.cpp
â”œâ”€â”€ include/            # ãƒ˜ãƒƒãƒ€ãƒ¼ãƒ•ã‚¡ã‚¤ãƒ« (.h/.hpp)
â”‚   â”œâ”€â”€ network.h
â”‚   â”œâ”€â”€ gamepad.h
â”‚   â”œâ”€â”€ thruster_control.h
â”‚   â””â”€â”€ sensor_data.h
â”œâ”€â”€ obj/                # ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«æ¸ˆã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆãƒ•ã‚¡ã‚¤ãƒ« (.o)
â””â”€â”€ bin/                # å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ« (ä¾‹: navigator_control)
```

### âœ… ã“ã®æ§‹æˆã®ãƒ¡ãƒªãƒƒãƒˆ
- **å½¹å‰²ã®åˆ†é›¢**ï¼šã‚³ãƒ¼ãƒ‰ã¨ãƒ“ãƒ«ãƒ‰æˆæœç‰©ã‚’æ˜ç¢ºã«åˆ†ã‘ã¦ç®¡ç†ã€‚
- **ã‚¹ã‚±ãƒ¼ãƒ©ãƒ“ãƒªãƒ†ã‚£**ï¼šãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«è¿½åŠ æ™‚ã®è¦‹é€šã—ãŒè‰¯ã„ã€‚
- **ã‚¯ãƒªãƒ¼ãƒ³ãªç®¡ç†**ï¼š`make clean` ã§ obj/bin ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã®ã¿å‰Šé™¤ã€‚

---

## ğŸ› ï¸ ãƒ“ãƒ«ãƒ‰æ–¹æ³•

### ğŸ”§ å‰ææ¡ä»¶
- g++ (C++11ä»¥é™)
```bash
sudo apt install build-essential
```
- [BlueRobotics Navigator-lib](https://github.com/bluerobotics/navigator-lib) ãŒãƒ“ãƒ«ãƒ‰æ¸ˆã¿ã§ã‚ã‚‹ã“ã¨ï¼ˆã‚ªãƒã‚±ã‹ã‚‰ç¢ºèªï¼‰  
  ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯ `~/navigator-lib/target/debug` ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹æƒ³å®šï¼‰

> **æ³¨:**  
> ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®ãƒ‘ã‚¹ã¯ç’°å¢ƒå¤‰æ•° `NAVIGATOR_LIB_PATH` ã§ä¸Šæ›¸ãå¯èƒ½ã§ã™ï¼š
>
> ```bash
> make -f Makefile.mk NAVIGATOR_LIB_PATH=/your/custom/path
> ```
>
> æ¯å›æ‰“ã¤ã®ãŒé¢å€’ãªå ´åˆã¯ã€ç’°å¢ƒå¤‰æ•°ã«æ›¸ã„ã¦ãŠãã¨ä¾¿åˆ©ã§ã™ï¼š
>
> ```bash
> export NAVIGATOR_LIB_PATH=/your/custom/path
> make -f Makefile.mk
> ```


### ğŸ”„ ãƒ“ãƒ«ãƒ‰æ‰‹é †
```bash
git clone https://github.com/Oryosan59/WS3
cd WS3
make -f Makefile.mk
```

### ğŸ§¹ ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒƒãƒ—
```bash
make -f Makefile.mk clean
```

---

## ğŸ¯ å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«
ãƒ“ãƒ«ãƒ‰æˆåŠŸå¾Œã€ä»¥ä¸‹ã®å®Ÿè¡Œãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã¾ã™ï¼š

```bash
./bin/navigator_control
```

---

## ğŸ® åŸºæœ¬çš„ãªä½¿ã„æ–¹

1.  ä¸Šè¨˜ã®æ‰‹é †ã«å¾“ã£ã¦ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ãƒ“ãƒ«ãƒ‰ã—ã€`./bin/navigator_control` ã‚’ç”Ÿæˆã—ã¾ã™ã€‚
2.  å¿…è¦ã«å¿œã˜ã¦ã€è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆå­˜åœ¨ã™ã‚‹å ´åˆï¼‰ã‚’ç·¨é›†ã—ã€ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®šã‚„åˆ¶å¾¡ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’èª¿æ•´ã—ã¾ã™ã€‚
3.  `./bin/navigator_control` ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚
    ```bash
    ./bin/navigator_control
    ```
4.  åœ°ä¸Šå±€ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢ï¼ˆåˆ¥é€”æº–å‚™ã¾ãŸã¯é–‹ç™ºï¼‰ã‚’èµ·å‹•ã—ã€æœ¬ã‚·ã‚¹ãƒ†ãƒ ãŒå‹•ä½œã™ã‚‹ãƒ‡ãƒã‚¤ã‚¹ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãƒ»ãƒãƒ¼ãƒˆã«æ¥ç¶šã—ã¾ã™ã€‚
5.  å¯¾å¿œã™ã‚‹ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã‚’PCã¾ãŸã¯Raspberry Piã«æ¥ç¶šã—ã¾ã™ã€‚
6.  ã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã®å…¥åŠ›ã«å¿œã˜ã¦ã‚¹ãƒ©ã‚¹ã‚¿ãƒ¼ãŒåˆ¶å¾¡ã•ã‚Œã€ã‚»ãƒ³ã‚µãƒ¼ãƒ‡ãƒ¼ã‚¿ãŒåœ°ä¸Šå±€ã«é€ä¿¡ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¾ã™ã€‚

> **æ³¨è¨˜:**
> - å…·ä½“çš„ãªã‚²ãƒ¼ãƒ ãƒ‘ãƒƒãƒ‰ã®ãƒœã‚¿ãƒ³å‰²ã‚Šå½“ã¦ã‚„ã€åœ°ä¸Šå±€ã¨ã®é€šä¿¡ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®è©³ç´°ã¯ã€ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰å†…ã®ã‚³ãƒ¡ãƒ³ãƒˆã‚„é–¢é€£ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’å‚ç…§ã—ã¦ãã ã•ã„ã€‚
> - åˆå›å®Ÿè¡Œæ™‚ã‚„ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢æ§‹æˆå¤‰æ›´å¾Œã¯ã€ã‚­ãƒ£ãƒªãƒ–ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ã‚„å‹•ä½œãƒ†ã‚¹ãƒˆã‚’æ…é‡ã«è¡Œã£ã¦ãã ã•ã„ã€‚

---

## ğŸ¤– ã‚µãƒ¼ãƒ“ã‚¹ã®è‡ªå‹•èµ·å‹• (systemd)

Raspberry Pi èµ·å‹•æ™‚ã« `navigator_control` ã‚’è‡ªå‹•çš„ã«å®Ÿè¡Œã—ã€ä¸‡ãŒä¸€ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒçµ‚äº†ã—ã¦ã‚‚è‡ªå‹•ã§å†èµ·å‹•ã™ã‚‹ã‚ˆã†ã«è¨­å®šã™ã‚‹ã“ã¨ã§ã€ãƒ˜ãƒƒãƒ‰ãƒ¬ã‚¹ç’°å¢ƒã§ã®é‹ç”¨ãŒéå¸¸ã«å®‰å®šã—ã¾ã™ã€‚ã“ã“ã§ã¯ `systemd` ã‚’ä½¿ã£ãŸã‚µãƒ¼ãƒ“ã‚¹åŒ–ã®æ–¹æ³•ã‚’èª¬æ˜ã—ã¾ã™ã€‚

### 1. ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ä½œæˆ

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã€`systemd` ã®ã‚µãƒ¼ãƒ“ã‚¹å®šç¾©ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚

```bash
sudo nano /etc/systemd/system/navigator_control.service
```

### 2. ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã®å†…å®¹

ã‚¨ãƒ‡ã‚£ã‚¿ãŒé–‹ã„ãŸã‚‰ã€ä»¥ä¸‹ã®å†…å®¹ã‚’ã‚³ãƒ”ãƒ¼ï¼†ãƒšãƒ¼ã‚¹ãƒˆã—ã¦ãã ã•ã„ã€‚`ExecStart` ã¨ `WorkingDirectory` ã®ãƒ‘ã‚¹ã¯ã€ã”è‡ªèº«ã®ç’°å¢ƒã«åˆã‚ã›ã¦ä¿®æ­£ã—ã¦ãã ã•ã„ã€‚

```ini
[Unit]
Description=Navigator Control Service
After=network.target

[Service]
ExecStart=/home/pi/ws3lan/bin/navigator_control
WorkingDirectory=/home/pi/ws3lan
StandardOutput=journal
StandardError=journal
Restart=always
RestartSec=3
User=pi

[Install]
WantedBy=multi-user.target
```

**ğŸ” è¨­å®šã®ãƒã‚¤ãƒ³ãƒˆ**
- `Restart=always`: ãƒ—ãƒ­ã‚°ãƒ©ãƒ ãŒçµ‚äº†ï¼ˆæ­£å¸¸ãƒ»ç•°å¸¸ã©ã¡ã‚‰ã§ã‚‚ï¼‰ã™ã‚‹ã¨ã€å¸¸ã«å†å®Ÿè¡Œã•ã‚Œã¾ã™ã€‚
- `RestartSec=3`: å†å®Ÿè¡Œã™ã‚‹å‰ã«3ç§’é–“å¾…æ©Ÿã—ã¾ã™ã€‚ã“ã‚Œã«ã‚ˆã‚Šã€é€£ç¶šã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã«ã‚ˆã‚‹ã‚µãƒ¼ãƒãƒ¼è² è·ã‚’é¿ã‘ã¾ã™ã€‚
- `WorkingDirectory`: `config.ini` ã®ã‚ˆã†ãªç›¸å¯¾ãƒ‘ã‚¹ã§æŒ‡å®šã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ­£ã—ãèª­ã¿è¾¼ã‚€ãŸã‚ã«é‡è¦ã§ã™ã€‚
- `User=pi`: `pi` ãƒ¦ãƒ¼ã‚¶ãƒ¼ã§ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ï¼ˆI2C, GPIOãªã©ï¼‰ã¸ã®ã‚¢ã‚¯ã‚»ã‚¹æ¨©é™ã‚’æŒã¤ãƒ¦ãƒ¼ã‚¶ãƒ¼ã‚’æŒ‡å®šã—ã¦ãã ã•ã„ã€‚
- `StandardOutput=journal`: `printf` ã‚„ `std::cout` ã«ã‚ˆã‚‹æ¨™æº–å‡ºåŠ›ã‚’ `journald` ã«è¨˜éŒ²ã—ã¾ã™ã€‚ãƒ­ã‚°ã®ç¢ºèªã«ä¾¿åˆ©ã§ã™ã€‚

### 3. ã‚µãƒ¼ãƒ“ã‚¹ã®æœ‰åŠ¹åŒ–ã¨èµ·å‹•

ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä¿å­˜ (`Ctrl+X` -> `Y` -> `Enter`) ã—ãŸã‚‰ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ã‚µãƒ¼ãƒ“ã‚¹ã‚’ã‚·ã‚¹ãƒ†ãƒ ã«ç™»éŒ²ã—ã€è‡ªå‹•èµ·å‹•ã‚’æœ‰åŠ¹åŒ–ã—ã¾ã™ã€‚

```bash
# systemdã«æ–°ã—ã„ã‚µãƒ¼ãƒ“ã‚¹ãƒ•ã‚¡ã‚¤ãƒ«ã‚’èªè­˜ã•ã›ã‚‹
sudo systemctl daemon-reload

# OSèµ·å‹•æ™‚ã®è‡ªå‹•å®Ÿè¡Œã‚’æœ‰åŠ¹åŒ–
sudo systemctl enable navigator_control.service

# ä»Šã™ãã‚µãƒ¼ãƒ“ã‚¹ã‚’èµ·å‹•
sudo systemctl start navigator_control.service
```

### 4. çŠ¶æ…‹ç¢ºèªã¨ãƒ­ã‚°ã®è¡¨ç¤º

ã‚µãƒ¼ãƒ“ã‚¹ãŒæ­£ã—ãå‹•ä½œã—ã¦ã„ã‚‹ã‹ç¢ºèªã™ã‚‹ã«ã¯ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

```bash
# ã‚µãƒ¼ãƒ“ã‚¹ã®å®Ÿè¡ŒçŠ¶æ…‹ã‚’ç¢ºèª (Active: active (running) ã¨è¡¨ç¤ºã•ã‚Œã‚Œã°æˆåŠŸ)
sudo systemctl status navigator_control.service

# ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ã§ãƒ­ã‚°ã‚’è¡¨ç¤º (Ctrl+Cã§çµ‚äº†)
journalctl -u navigator_control.service -f
```

ã“ã‚Œã§ã€Raspberry Pi ã‚’å†èµ·å‹•ã—ã¦ã‚‚ `navigator_control` ãŒè‡ªå‹•ã§å®Ÿè¡Œã•ã‚Œã‚‹ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚

---

## ğŸ”Œ å¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒª

- [BlueRobotics Navigator-lib](https://github.com/bluerobotics/navigator-lib)  
  ã‚»ãƒ³ã‚µãƒ»PWMå‡ºåŠ›ãƒ»ã‚¹ãƒ©ã‚¹ã‚¿ãƒ¼åˆ¶å¾¡ã‚’è¡Œã†ãŸã‚ã®Rustãƒ™ãƒ¼ã‚¹ãƒ©ã‚¤ãƒ–ãƒ©ãƒªï¼ˆC/C++ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’ä½¿ç”¨ï¼‰

---

## ğŸ ã‚ªãƒã‚±ï¼šNavigator-lib & Flight Controller ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰

ã“ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã§ä½¿ç”¨ã—ã¦ã„ã‚‹ [BlueRobotics Navigator-lib](https://github.com/bluerobotics/navigator-lib) ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ§‹ç¯‰æ–¹æ³•ã¨ã€Raspberry Pi ä¸Šã§ Navigator Flight Controller ã‚’ä½¿ã†ãŸã‚ã®æº–å‚™æ‰‹é †ã‚’ç´¹ä»‹ã—ã¾ã™ğŸ› ï¸âœ¨

---

### ğŸ§± 1. Raspberry Pi Imager ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

#### 1.1 Raspberry Pi Imager ã®å…¥æ‰‹
- [å…¬å¼ã‚µã‚¤ãƒˆ](https://www.raspberrypi.com/software/)ã‹ã‚‰ã€ãŠä½¿ã„ã®OSã«å¯¾å¿œã™ã‚‹ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ï¼†ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦ãã ã•ã„ã€‚

---

### ğŸ’¿ 2. Raspberry Pi OS ã‚¤ãƒ¡ãƒ¼ã‚¸ã®æº–å‚™

#### 2.1 OSã‚¤ãƒ¡ãƒ¼ã‚¸ã®é¸å®šï¼ˆLiteæ¨å¥¨ï¼‰
ä»¥ä¸‹ã®ã„ãšã‚Œã‹ã‚’é¸ã³ã¾ã™ã€‚

| ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ | ãƒ•ã‚¡ã‚¤ãƒ«å | ã‚µã‚¤ã‚º | ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ãƒªãƒ³ã‚¯ |
|----------------|------------|--------|------------------|
| 32-bit (armhf) | 2023-02-21-raspios-bullseye-armhf-lite.img.xz | ç´„362MB | [DLãƒªãƒ³ã‚¯](https://downloads.raspberrypi.com/raspios_lite_armhf/images/raspios_lite_armhf-2023-02-22/) |
| 64-bit (arm64) | 2023-02-21-raspios-bullseye-arm64-lite.img.xz | ç´„307MB | [DLãƒªãƒ³ã‚¯](https://downloads.raspberrypi.com/raspios_lite_arm64/images/raspios_lite_arm64-2023-02-22/) |

![Image](https://github.com/user-attachments/assets/a0fb8328-bb0a-4a6b-b84a-f3993df9bd4e)
ä¸€ç•ªä¸Šã‚’é¸æŠã—ã¾ã™

### 2.2 Raspberry Pi Imager ã§ microSD ã«ãƒ•ãƒ©ãƒƒã‚·ãƒ¥
1. Imager ã‚’èµ·å‹•ã—ã€ä¸Šè¨˜ã§ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã—ãŸã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’é¸æŠ

    ![Image](https://github.com/user-attachments/assets/c4475b9c-18ef-4990-a089-462760b79c10)
    ![Image](https://github.com/user-attachments/assets/0fea632b-a403-4720-b0ea-051ba5aef1e5)

2. è¨­å®šã‚’ç·¨é›†ã™ã‚‹ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦ä»¥ä¸‹ã‚’è¨­å®šï¼š
   - ãƒ›ã‚¹ãƒˆåã€ãƒ¦ãƒ¼ã‚¶ãƒ¼åã€ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®è¨­å®š
   - Wi-Fiè¨­å®šï¼ˆSSIDã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰å…¥åŠ›ã€‚**ã‚¹ãƒ†ãƒ«ã‚¹SSIDã®ãƒã‚§ãƒƒã‚¯ã¯å¤–ã™**ï¼‰
   - ãƒ­ã‚±ãƒ¼ãƒ«ï¼š
     - ã‚¿ã‚¤ãƒ ã‚¾ãƒ¼ãƒ³ï¼šAsia/Tokyo
     - ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆï¼šjp
   - ã‚µãƒ¼ãƒ“ã‚¹ï¼šSSH ã‚’æœ‰åŠ¹åŒ–


    ![Image](https://github.com/user-attachments/assets/b457e316-caff-48e7-82dc-f9ec5a33a81a)
    ![Image](https://github.com/user-attachments/assets/92d853b0-1c52-42b7-bb09-f8303e310996)

3. microSD ã«æ›¸ãè¾¼ã¿é–‹å§‹

---

## ğŸŒ 3. ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯è¨­å®š
MicroHDMIã¨ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚’ãƒ©ã‚ºãƒ‘ã‚¤ã«æ¥ç¶šã—ã€æ“ä½œã—ã¾ã™


### 3.1 å›ºå®šIPè¨­å®šï¼ˆæœ‰ç·šLANï¼‰
```bash
sudo nano /etc/dhcpcd.conf
```
ãƒ•ã‚¡ã‚¤ãƒ«æœ€ä¸‹éƒ¨ã«è¿½è¨˜ï¼š
```conf
interface eth0
static ip_address=192.168.4.100/24
```
è¨˜å…¥ãŒçµ‚ã‚ã£ãŸã‚‰ã€çµ‚äº†ã™ã‚‹: `Ctrl + X`ï¼ˆã€ŒExitã€ï¼‰
ã€ŒSave modified buffer?ã€ã¨è¡¨ç¤ºã•ã‚Œã‚‹ã®ã§ã€`Y`ï¼ˆYesï¼‰ã‚’æŠ¼ã—ã¦ä¿å­˜ã—ã¾ã™

---

## ğŸ–¥ï¸ 4. Tera Term / ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã®æœ‰ç·šSSHæ¥ç¶š

### âš™ï¸ å‰ææ¡ä»¶
- Raspberry Piã¨PCã‚’LANã‚±ãƒ¼ãƒ–ãƒ«ã§æ¥ç¶šï¼ˆã‚¹ã‚¤ãƒƒãƒãƒ³ã‚°ãƒãƒ–çµŒç”±ã¾ãŸã¯ç›´æ¥æ¥ç¶šï¼‰
- Raspberry Piã«å›ºå®šIPã‚’è¨­å®šæ¸ˆã¿ï¼ˆä¾‹: `192.168.4.100`ï¼‰

---

### ğŸªŸ 4.1 Windowsï¼šTera Term ã§æ¥ç¶šã™ã‚‹

#### 4.1.1 Tera Term ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
1. å…¬å¼ã‚µã‚¤ãƒˆã‹ã‚‰ Tera Term ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰:  
   [https://ttssh2.osdn.jp/](https://ttssh2.osdn.jp/)
2. ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ©ãƒ¼ã‚’å®Ÿè¡Œã—ã¦ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

#### 4.1.2 æ¥ç¶šæ‰‹é †
1. Tera Term ã‚’èµ·å‹•
2. ã€Œãƒ›ã‚¹ãƒˆã€æ¬„ã« Raspberry Pi ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ï¼ˆä¾‹: `192.168.4.100`ï¼‰ã‚’å…¥åŠ›
3. ã€ŒSSHã€ã‚’é¸æŠã—ã€OKã‚’ã‚¯ãƒªãƒƒã‚¯
4. ãƒ¦ãƒ¼ã‚¶ãƒ¼åã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ï¼ˆä¾‹: `pi / raspberry`ï¼‰

âœ… æ¥ç¶šã«æˆåŠŸã™ã‚‹ã¨ã€Raspberry Pi ã®ã‚·ã‚§ãƒ«ç”»é¢ãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---

### ğŸ 4.2 macOSï¼šã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§SSHæ¥ç¶šã™ã‚‹

#### 4.2.1 æ¨™æº–ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã‚’ä½¿ç”¨
1. ã€Œã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã€ã‚¢ãƒ—ãƒªã‚’é–‹ãï¼ˆ`Command + Space` â†’ "terminal" ã¨å…¥åŠ›ï¼‰
2. ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§æ¥ç¶šï¼š

```bash
ssh pi@192.168.1.100
```

3. æœ€åˆã®æ¥ç¶šæ™‚ã«è¡¨ç¤ºã•ã‚Œã‚‹ fingerprint ã®ç¢ºèªãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã§ã€Œyesã€ã¨å…¥åŠ›
4. ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ï¼ˆè¡¨ç¤ºã•ã‚Œãªã„ãŒæ‰“ã¦ã¦ã¾ã™ï¼‰

âœ… ãƒ­ã‚°ã‚¤ãƒ³ã«æˆåŠŸã™ã‚‹ã¨ã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã« `pi@raspberrypi` ã®ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãŒè¡¨ç¤ºã•ã‚Œã¾ã™ã€‚

---

### ğŸ’¡ è£œè¶³ï¼šæ¥ç¶šã§ããªã„ã¨ãã®ãƒã‚§ãƒƒã‚¯ãƒã‚¤ãƒ³ãƒˆ
- Raspberry Pi ã®é›»æºãŒå…¥ã£ã¦ã„ã‚‹ã‹
- LANã‚±ãƒ¼ãƒ–ãƒ«ãŒç¢ºå®Ÿã«æ¥ç¶šã•ã‚Œã¦ã„ã‚‹ã‹
- Raspberry Pi å´ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒæ­£ã—ã„ã‹ï¼ˆ`ifconfig` ã¾ãŸã¯ `ip a` ã§ç¢ºèªå¯èƒ½ï¼‰
- ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®å½±éŸ¿ãŒãªã„ã‹

---

## ğŸŒ 5. Windows / macOS ã§ã®æœ‰ç·šLANå›ºå®šIPè¨­å®šã‚¬ã‚¤ãƒ‰

Raspberry Piã¨PCã‚’LANã‚±ãƒ¼ãƒ–ãƒ«ã§**ç›´æ¥æ¥ç¶š**ã¾ãŸã¯**ãƒãƒ–çµŒç”±ã§ãƒ­ãƒ¼ã‚«ãƒ«æ¥ç¶š**ã™ã‚‹å ´åˆã€ãŠäº’ã„ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã‚’å›ºå®šã«ã™ã‚‹å¿…è¦ãŒã‚ã‚Šã¾ã™
ã“ã“ã§ã¯ã€**Raspberry Piã®IPã‚’ `192.168.4.100` ã«å›ºå®š**ã™ã‚‹å‰æã§ã€**PCå´ã‚’ `192.168.4.10`** ã«è¨­å®šã™ã‚‹æ–¹æ³•ã‚’è§£èª¬ã—ã¾ã™

---

### ğŸªŸ 5.1 Windowsã§ã®è¨­å®šæ–¹æ³•

#### ğŸ“Œ æ‰‹é †
1. **[è¨­å®š] â†’ [ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã¨ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆ] â†’ [ã‚¢ãƒ€ãƒ—ã‚¿ãƒ¼ã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’å¤‰æ›´ã™ã‚‹]** ã‚’é–‹ã
2. æœ‰ç·šLANï¼ˆä¾‹:ã€Œã‚¤ãƒ¼ã‚µãƒãƒƒãƒˆã€ï¼‰ã‚’**å³ã‚¯ãƒªãƒƒã‚¯ â†’ [ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£]**
3. ã€Œã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒƒãƒˆãƒ—ãƒ­ãƒˆã‚³ãƒ« ãƒãƒ¼ã‚¸ãƒ§ãƒ³4 (TCP/IPv4)ã€ã‚’é¸æŠã—**[ãƒ—ãƒ­ãƒ‘ãƒ†ã‚£]**
4. ä»¥ä¸‹ã®ã‚ˆã†ã«è¨­å®šï¼š

| é …ç›® | è¨­å®šå†…å®¹ |
|------|----------|
| IPã‚¢ãƒ‰ãƒ¬ã‚¹ | `192.168.4.10` |
| ã‚µãƒ–ãƒãƒƒãƒˆãƒã‚¹ã‚¯ | `255.255.255.0` |
| ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚²ãƒ¼ãƒˆã‚¦ã‚§ã‚¤ | ï¼ˆç©ºç™½ã§OKï¼‰ |
| DNS | ï¼ˆç©ºç™½ã¾ãŸã¯ `8.8.8.8`ï¼‰ |

5. [OK] ã‚’ã‚¯ãƒªãƒƒã‚¯ã—ã¦è¨­å®šã‚’ä¿å­˜

âœ… æ¥ç¶šå¾Œã€Tera Termã§ `192.168.4.100` ã«SSHå¯èƒ½ã«ãªã‚‹ã¯ãšã§ã™

---

### ğŸ 5.2 macOSã§ã®è¨­å®šæ–¹æ³•

#### ğŸ“Œ æ‰‹é †
1. **[ã‚·ã‚¹ãƒ†ãƒ è¨­å®š] â†’ [ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯]** ã‚’é–‹ã
2. å·¦ãƒ¡ãƒ‹ãƒ¥ãƒ¼ã‹ã‚‰ã€Œæœ‰ç·šEthernetã€ã¾ãŸã¯ã€ŒUSB LANã‚¢ãƒ€ãƒ—ã‚¿ã€ã‚’é¸æŠ
3. ã€Œè©³ç´°ã€â†’ ã€ŒTCP/IPã€ã‚¿ãƒ–ã‚’é–‹ã
4. ã€ŒIPv4ã®è¨­å®šã€â†’ã€Œæ‰‹å…¥åŠ›ï¼ˆManuallyï¼‰ã€ã‚’é¸æŠ
5. ä»¥ä¸‹ã‚’å…¥åŠ›ï¼š

| é …ç›® | è¨­å®šå†…å®¹ |
|------|----------|
| IPã‚¢ãƒ‰ãƒ¬ã‚¹ | `192.168.4.10` |
| ã‚µãƒ–ãƒãƒƒãƒˆãƒã‚¹ã‚¯ | `255.255.255.0` |
| ãƒ«ãƒ¼ã‚¿ãƒ¼ | ç©ºç™½ï¼ˆã¾ãŸã¯ `192.168.1.1`ï¼‰ |

6. [OK] â†’ [é©ç”¨] ã‚’ã‚¯ãƒªãƒƒã‚¯

âœ… ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ `ssh pi@192.168.4.100` ã§æ¥ç¶šå¯èƒ½ã«ãªã‚Šã¾ã™

---

### ğŸ§ª æ¥ç¶šãƒ†ã‚¹ãƒˆ

PCã‹ã‚‰ä»¥ä¸‹ã®ã‚ˆã†ã« Raspberry Pi ã« ping ã‚’é€ã£ã¦ç¢ºèªã—ã¾ã™ï¼š

```bash
ping 192.168.4.100
```

`å¿œç­”ãŒã‚ã‚Šã¾ã™` ã‚„ `bytes from 192.168.4.100` ã®ã‚ˆã†ãªè¡¨ç¤ºãŒå‡ºã‚Œã°ã€æ¥ç¶šæˆåŠŸã§ã™ï¼

---


## ğŸ› ï¸ 6. å¿…è¦ãªãƒ„ãƒ¼ãƒ«ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
æ¥ç¶šå¾Œã€ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§å®Ÿè¡Œã—ã¾ã™

```bash
sudo apt update
sudo apt install git i2c-tools
```

---

## ğŸ§­ 7. Navigator ãƒãƒ¼ãƒ‰ã‚¦ã‚§ã‚¢ã®ã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—
 [BlueRobotics Navigator-lib](https://github.com/bluerobotics/navigator-lib)   ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°æ§‹ç¯‰æ–¹æ³•ã¨ã€Raspberry Pi ä¸Šã§ Navigator Flight Controller ã‚’ä½¿ã†ãŸã‚ã®æº–å‚™æ‰‹é †ã‚’ç´¹ä»‹ã—ã¾ã™
 
### 7.1 ã‚ªãƒ¼ãƒãƒ¼ãƒ¬ã‚¤è¨­å®šã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å®Ÿè¡Œ
```bash
sudo su -c 'curl -fsSL https://raw.githubusercontent.com/bluerobotics/blueos-docker/master/install/boards/configure_board.sh | bash'
sudo reboot
```

---

## ğŸ§ª 8. Navigator-lib ã®ãƒ“ãƒ«ãƒ‰ã¨å®Ÿè¡Œ

### 8.1 ä¾å­˜ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
```bash
sudo apt install cmake git
curl --proto '=https' --tlsv1.2 -sSf https://sh.rustup.rs | sh
source "$HOME/.cargo/env"
```

### 8.2 ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã®å–å¾—ã¨ãƒ“ãƒ«ãƒ‰
```bash
git clone https://github.com/bluerobotics/navigator-lib.git
cd navigator-lib/examples/cpp
cmake -B build -DCMAKE_BUILD_TYPE=Debug
cmake --build build --config Debug --parallel
```
> **å‚™è€ƒ**: C++ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã®ãƒ“ãƒ«ãƒ‰çµæœã¯ `navigator-lib/target/debug` ã«é…ç½®ã•ã‚Œã‚‹ãŸã‚ã€`Makefile` ã§ `NAVIGATOR_LIB_PATH` ã«ã“ã®ãƒ‘ã‚¹ã‚’æŒ‡å®šã—ã¦åˆ©ç”¨ã—ã¾ã™ã€‚

### 8.3 ã‚µãƒ³ãƒ—ãƒ«ã®å®Ÿè¡Œ
```bash
./build/simple
./build/rainbow
```

ä»¥ä¸Šã§ã€Raspberry Pi 4B + Navigator-lib ã®æº–å‚™ãŒå®Œäº†ã§ã™ï¼ğŸ’¡

---

## ğŸ§­ ä½œè€…

**Oryosan59**  
https://github.com/Oryosan59
